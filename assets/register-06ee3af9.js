import"./backtotop-e6f982ee.js";import{a as R}from"./axios-21b846bc.js";import{f as i}from"./firebase-f51430d4.js";const V="https://project-code-json-k0ti.onrender.com";function r(e){e.classList.remove("is-valid"),e.classList.add("is-invalid")}function l(e){e.classList.remove("is-invalid"),e.classList.add("is-valid")}let d=document.querySelector("#floatingEmail"),u=document.querySelector("#floatingName"),c=document.querySelector("#floatingTel"),n=document.querySelector("#floatingPassword"),p=document.querySelector("#floatingCheckPassword");d.addEventListener("input",L);u.addEventListener("input",x);c.addEventListener("input",k);n.addEventListener("input",b);p.addEventListener("input",E);const s={email:"",password:"",user_phone:"",user_name:"",user_role:"學生",user_title:"",user_avatar:"",user_birthdate:"",user_gender:"",user_address:""};let g=!1,h=!1,v=!1,w=!1,S=!1;function L(){const e=d.value;s.email=e,/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)?(l(d),g=!0):r(d),a()}function x(){const e=u.value;s.user_name=e,/^.{1,20}$/.test(e)?(l(u),h=!0):r(u),a()}function k(){const e=c.value;s.user_phone=e,/^09\d{8}$/.test(e)?(l(c),v=!0):r(c),a()}function b(){const e=n.value;s.password=e,/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/.test(e)?(l(n),w=!0):r(n),a()}function E(){let e=n.value,t=p.value;console.log("passwordCheckValue：",t),t==e&&t?(l(p),S=!0):r(p),a()}function _(e){R.post(`${V}/users`,e).then(t=>{console.log(t.data),new bootstrap.Modal("#registerSuccess").show()}).catch(t=>{console.error(t),t.response.data=="Email already exists"&&Swal.fire({icon:"error",title:"此帳號已註冊",text:"請前往登入頁面或註冊新帳號"})})}const m=document.querySelector("#registerBtn");function a(){g&&h&&v&&w&&S?m.removeAttribute("disabled"):m.setAttribute("disabled","true")}a();m.addEventListener("click",function(e){e.preventDefault(),_(s)});const f=document.querySelector("#google-register");f&&f.addEventListener("click",function(){i.signInWithPopup(i.auth,i.provider).then(e=>{i.GoogleAuthProvider.credentialFromResult(e).accessToken;const o=e.user;s.email=o.email,s.password="00000000",s.user_name=o.email,s.user_phone=o.phoneNumber,s.user_avatar=o.photoURL,_(s)}).catch(e=>{console.error(e)})});
